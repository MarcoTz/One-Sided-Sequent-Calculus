<!DOCTYPE html>
<html>
  <head>
    <title>One-Sided Sequent Calculus</title>
    <link rel="stylesheet" href="main.css"/>
    <script>
      function runExample(){
        contents = document.getElementById("progInput").value;
        globalCompiler(contents);
      }

      function setExample(exampleId) {
        exampleValue = document.getElementById(exampleId).textContent;
        // remove indendation from html
        exampleValue = exampleValue.replaceAll(/^        /gm,'').trim();
        document.getElementById("progInput").value = exampleValue;
      }

      function exampleChosen() {
        exampleId = document.getElementById('exampleSelect').value;
        setExample(exampleId);
      }
    </script>
  </head>
  <body onLoad = "setExample('tuple')">
    <h1>One Sided Sequent Calculus</h1>
    <div>Choose Example:
      <select id="exampleSelect" onChange="exampleChosen()">
        <option value="tuple">Tuples</option>
        <option value="list">Lists</option>
        <option value="nat">Natural Numbers</option>
        <option value="fun">Functions</option>
      </select>
    </div>
    <div class="prog">
      <textarea id="progInput"> 
      </textarea>
      <button id="runButton" onClick="runExample()" >Run</button>
    </div>
    <div class="results">
      <h2>Results</h2>
      <div id="resultStr"></div>
      Trace: <br/>
      <div id="traceStr"></div>
    </div>
    <div id="examples">
      <div id="tuple">
        data Pair(a:+,b:+):+{
          Tup(a,b)
        }
        data Nat :+ {
          Z,
          S(Nat)
        }
        data Fun(a:+,b:-):- { 
          Ap(a,b)
        }

        printCons :: forall X.X:-;
        printCons := mu x.Print x;
      
        swap :: forall X Y. Fun(Pair(X,Y),Pair(Y,X)):+;
        swap := case { Ap(p,a) =&gt;
          &lt; case { 
            Tup(b,c) =&gt; &lt; Tup(c,b) | Pair(Y,X):+ | + | a&gt;
            } | + | p&gt;
        };
      
        pair1 :: Pair(Nat,Nat):+;
        pair1 := Tup(Z,S(Z));
      
        main := &lt; swap | + | Ap(pair1,printCons)&gt;;
      </div>
      
      <div id="list">
        data List(a:+):+{
          Nil,
          Cons(a,List(a))
        } 
        
        data Fun(a:+,b:-):- { 
          Ap(a,b)
        }

        data Unit : + { MkUnit }

        printCons :: forall X. X:-;
        printCons := mu x.Print x;
      
        tail :: forall X. Fun(List(X),List(X)) : +;
        tail := case { Ap(ls,a) =&gt; 
          &lt; case { 
            Nil         =&gt; &lt;Nil | + | a&gt;,
            Cons(hd,rs) =&gt; &lt;rs  | + | a&gt;
          } | + | ls&gt;
        };
      
        list1 :: List(Unit):+;
        list1 := Cons(MkUnit,Cons(MkUnit,Nil));
      
        main := &lt; tail | + | Ap(list1,printCons)&gt;;
      </div>
      
      <div id="nat">
        data Nat : + {
          Z,
          S(Nat)
        }
        data Fun(a:+,b:-):- { 
          Ap(a,b)
        }
        printCons :: Forall X.X:-;
        printCons := mu x. Print x;
      
        pred :: Fun(Nat,Nat):+;
        pred := case { Ap(n,a) =&gt;
          &lt; case { 
            Z =&gt; &lt; Z | + | a&gt;,
            S(m) =&gt; &lt; m | + | a &gt;
          } | + | n&gt;
        };

        nat1 :: Nat:+;
        nat1 := S(S(Z));
      
        main := &lt; pred | + | Ap(nat1,printCons)&gt;;
      </div>
      
      <div id="fun">
        data Fun(a:+,b:-):- { 
          Ap(a,b)
        }
        
        data Unit:+ {MkUnit}

        printCons :: Forall X.X:-;
        printCons := mu x. Print x;

        id :: forall X. Fun(X,X) : +;
        id := case { Ap(x,a) =&gt; &lt;x | + | a&gt; };
      
        main := &lt; id | + | Ap(MkUnit,printCons)&gt;; 
      </div>
    </div>
  </body>
  <script src="all.js" defer></script>
</html>
